<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>Compare.html</title>
	<link rel="stylesheet" href="modules/compare.css">
	<script src="modules/jquery-3.2.1.min.js"></script>
	<script src="modules/compare-util.js" defer></script>
	<script src="compare.js" defer></script>
</head>
<body class="en">
<script>
var changeLang = function(lang) {
  if (lang !== '') {
    var newURL = location.href.replace(/\?.*/, '') + '?lang=' + lang;
    window.history.replaceState('', '', newURL);
    document.body.setAttribute('class', lang);
  }
};
(function() {
  var m = location.search.match(/(?:\?|\&)lang\=([^&]+)/);
  var lang = m ? m[1] : (
    (window.navigator.languages && window.navigator.languages[0]) ||
    window.navigator.language ||
    window.navigator.userLanguage ||
    window.navigator.browserLanguage);
  if (lang && lang.match(/^ja/)) {
    document.body.setAttribute('class', 'ja');
  }
})();
</script>

<input type="file" id="file" style="display:none;" accept="image/*" multiple />
<div id="viewroot">
	<div id="sidebar">
		<button id="add">
			<img src="res/add.svg" width="100%">
			<span class="tooltip en">Add new picture</span>
			<span class="tooltip ja">画像を追加</span>
		</button>
		<div class="space"></div>
		<button id="analysisbtn">
			<img src="res/histogram.svg" width="100%">
			<span class="tooltip keys en">Show analysis tools <span>a</span></span>
			<span class="tooltip keys ja">分析ツールを表示 <span>a</span></span>
		</button>
		<button id="zoomIn">
			<img src="res/zoomin.svg" width="100%">
			<span class="tooltip keys en">Zoom in <span>+</span></span>
			<span class="tooltip keys ja">拡大 <span>+</span></span>
		</button>
		<button id="zoomOut">
			<img src="res/zoomout.svg" width="100%">
			<span class="tooltip keys en">Zoom out <span>-</span></span>
			<span class="tooltip keys ja">縮小 <span>-</span></span>
		</button>
		<button id="arrange">
			<img src="res/layout_x.svg" width="100%">
			<span class="tooltip keys en">Arrange layout <span>/</span></span>
			<span class="tooltip keys ja">レイアウト変更 <span>/</span></span>
		</button>
		<button id="overlay">
			<img src="res/overlay.svg" width="100%">
			<span class="tooltip keys en">Overlay mode <span>o</span></span>
			<span class="tooltip keys ja">オーバーレイモード <span>o</span></span>
		</button>
		<button id="gridbtn">
			<img src="res/grid.svg" width="100%">
			<span class="tooltip keys en">Show grid <span>g</span></span>
			<span class="tooltip keys ja">グリッドを表示 <span>g</span></span>
		</button>
		<button id="pickerbtn">
			<img src="res/rgb.svg" width="100%">
			<span class="tooltip keys en">Show color picker <span>p</span></span>
			<span class="tooltip keys ja">カラーピッカーを表示 <span>p</span></span>
		</button>
		<div class="bottom">
			<button id="fullscreen">
				<img src="res/full.svg" width="100%">
				<span class="tooltip keys en">Fullscreen <span>f</span></span>
				<span class="tooltip keys ja">フルスクリーン表示 <span>f</span></span>
			</button>
			<div class="space"></div>
			<button id="helpbtn">
				<img src="res/help.svg" width="100%">
				<span class="tooltip keys en">Show help <span>?</span></span>
				<span class="tooltip keys ja">ヘルプを表示 <span>?</span></span>
			</button>
		</div>
	</div>
	<div id="view">
		<div class="hudContainer">
			<div id="mode" class="light hud">
				<span class="en"></span>
				<span class="ja"></span>
			</div>
			<div id="map" class="dark hud">
				<svg>
					<clipPath id="mapClip">
						<rect x="0" y="0" width="100%" height="100%"></rect>
					</clipPath>
					<g stroke="none" fill="none" stroke-width="0.5" opacity="0.4">
						<rect id="mapROI" fill="gray" clip-path="url(#mapClip)"></rect>
						<rect id="mapFrame" stroke="white" x="0" y="0" width="100%" height="100%"></rect>
					</g>
				</svg>
			</div>
		</div>
		<div class="emptyBox" id="drop">
			<div class="dropHere">
				<span class="en">Drop image files here</span>
				<span class="ja">ここに画像ファイルをドラッグ＆ドロップ</span>
			</div>
		</div>
		<div class="emptyBox">
			<div class="dropHere">
				<span class="en">Drop image files here</span>
				<span class="ja">ここに画像ファイルをドラッグ＆ドロップ</span>
			</div>
		</div>
	</div>
	<div id="shortcuts" class="dialog">
		<div>
			<div class="header">
				<div>
					<h3>
						<span class="en">Compare.html -image comparison tool-</span>
						<span class="ja">Compare.html -画像比較ツール-</span>
					</h3>
					<p><a href="https://github.com/tshino/compare" target="_blank">https://github.com/tshino/compare</a></p>
				</div>
				<div>
					<select id="selectLang" onchange="changeLang(this.options[this.selectedIndex].value)">
						<option value="">(Select language)</option>
						<option value="ja">日本語</option>
						<option value="en">English</option>
					</select>
				</div>
			</div>
			<table>
				<tr>
					<th>
						<span class="en">Keyboard shortcuts</span>
						<span class="ja">キーボードショートカット</span>
					<th>
				</tr>
				<tr>
					<td class="keys"><span>+</span> / <span>-</span> / <span>PgUp</span> / <span>PgDn</span></td>
					<td><span class="en">zoom in/out</span><span class="ja">拡大/縮小</span></td>
				</tr>
				<tr>
					<td class="keys"><span>←</span> / <span>→</span> / <span>↑</span> / <span>↓</span></td>
					<td><span class="en">scroll</span><span class="ja">スクロール</span></td>
				</tr>
				<tr>
					<td class="keys"><span>1</span> / <span>2</span> / ... </td>
					<td><span class="en">switch to single picture view</span><span class="ja">1枚画像表示に切り替え</span></td>
				</tr>
				<tr>
					<td class="keys"><span>Tab</span></td>
					<td><span class="en">flip single picture view</span><span class="ja">1枚画像表示を順に切り替え</span></td>
				</tr>
				<tr>
					<td class="keys"><span>0</span></td>
					<td><span class="en">show all pictures</span><span class="ja">すべての画像を表示</span></td>
				</tr>
				<tr>
					<td class="keys"><span>/</span></td>
					<td><span class="en">arrange layout</span><span class="ja">レイアウト変更</span></td>
				</tr>
				<tr>
					<td class="keys"><span>Esc</span></td>
					<td><span class="en">reset zoom</span><span class="ja">拡大状態をリセット</span></td>
				</tr>
				<tr>
					<td class="keys"><span>o</span></td>
					<td><span class="en">overlay mode</span><span class="ja">オーバーレイモード</span></td>
				</tr>
				<tr>
					<td class="keys"><span>g</span></td>
					<td><span class="en">show grid</span><span class="ja">グリッドを表示</span></td>
				</tr>
				<tr>
					<td class="keys"><span>a</span></td>
					<td><span class="en">analysis tools</span><span class="ja">分析ツール</span></td>
				</tr>
				<tr>
					<td class="keys"><span>i</span></td>
					<td><span class="en">image information</span><span class="ja">画像情報</span></td>
				</tr>
				<tr>
					<td class="keys"><span>h</span></td>
					<td><span class="en">histogram</span><span class="ja">ヒストグラム</span></td>
				</tr>
				<tr>
					<td class="keys"><span>w</span></td>
					<td><span class="en">waveform</span><span class="ja">波形</span></td>
				</tr>
				<tr>
					<td class="keys"><span>v</span></td>
					<td><span class="en">vectorscope</span><span class="ja">ベクトルスコープ</span></td>
				</tr>
				<tr>
					<td class="keys"><span>c</span></td>
					<td><span class="en">3D color distribution</span><span class="ja">3次元色分布</span></td>
				</tr>
				<tr>
					<td class="keys"><span>m</span></td>
					<td><span class="en">Image quality metrics</span><span class="ja">画質メトリクス</span></td>
				</tr>
				<tr>
					<td class="keys"><span>d</span></td>
					<td><span class="en">Image diff</span><span class="ja">画像のdiff</span></td>
				</tr>
				<tr>
					<td class="keys"><span>f</span></td>
					<td><span class="en">full screen</span><span class="ja">フルスクリーン表示</span></td>
				</tr>
				<tr>
					<td class="keys"><span>?</span></td>
					<td><span class="en">show help</span><span class="ja">ヘルプ</span></td>
				</tr>
			</table>
		</div>
	</div>
	<div id="info" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/info.svg" width="20">
					<span class="en">Image information</span>
					<span class="ja">画像情報</span>
				</h3>
			</div>
			<div>
				<table id="infoTable">
					<tr id="infoName">
						<td class="prop">
							<span class="en">name</span>
							<span class="ja">名前</span>
						</td>
					</tr>
					<tr id="infoFormat">
						<td class="prop">
							<span class="en">format (*)</span>
							<span class="ja">ファイル形式 (※)</span>
						</td>
					</tr>
					<tr id="infoWidth" class="num">
						<td class="prop">
							<span class="en">width [px]</span>
							<span class="ja">幅 [px]</span>
						</td>
					</tr>
					<tr id="infoHeight" class="num">
						<td class="prop">
							<span class="en">height [px]</span>
							<span class="ja">高さ [px]</span>
						</td>
					</tr>
					<tr id="infoAspect" class="num">
						<td class="prop">
							<span class="en">aspect ratio</span>
							<span class="ja">アスペクト比</span>
						</td>
					</tr>
					<tr id="infoOrientation" class="enum">
						<td class="prop">
							<span class="en">orientation (Exif)</span>
							<span class="ja">回転方向 (Exif)</span>
						</td>
					</tr>
					<tr id="infoFileSize" class="num">
						<td class="prop">
							<span class="en">file size [bytes]</span>
							<span class="ja">ファイルサイズ [バイト]</span>
						</td>
					</tr>
					<tr id="infoLastModified" class="date">
						<td class="prop">
							<span class="en">file last modified date</span>
							<span class="ja">ファイル更新日時</span>
						</td>
					</tr>
				</table>
				<div class="footnote">
					<span class="en">
						* File format is determined from the contents of the file.
					</span>
					<span class="ja">
						※ ファイル形式はファイルの内容に基づいて判定しています
					</span>
				</div>
			</div>
		</div>
	</div>
	<div id="loading" class="dialog">
		<div>
			<h3 id="loadingStatus">
				<span class="en"></span>
				<span class="ja"></span>
			</h3>
			<table id="loadingList">
			</table>
		</div>
	</div>
	<div id="analysis" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/histogram.svg" width="20">
					<span class="en">Analysis Tools</span>
					<span class="ja">分析ツール</span>
				</h3>
			</div>
			<div class="menu">
				<button id="infobtn">
					<img src="res/info.svg" width="20">
					<span class="en">Image information</span>
					<span class="ja">画像情報</span>
					<span class="flat keys"><span>i</span></span>
				</button>
				<button id="histogrambtn">
					<img src="res/histogram.svg" width="20">
					<span class="en">Histogram</span>
					<span class="ja">ヒストグラム</span>
					<span class="flat keys"><span>h</span></span>
				</button>
				<button id="waveformbtn">
					<img src="res/waveform.svg" width="20">
					<span class="en">Waveform</span>
					<span class="ja">波形</span>
					<span class="flat keys"><span>w</span></span>
				</button>
				<button id="vectorscopebtn">
					<img src="res/vectorscope.svg" width="20">
					<span class="en">Vectorscope</span>
					<span class="ja">ベクトルスコープ</span>
					<span class="flat keys"><span>v</span></span>
				</button>
				<button id="colordistbtn">
					<img src="res/colordist.svg" width="20">
					<span class="en">3D Color Distribution</span>
					<span class="ja">3次元色分布</span>
					<span class="flat keys"><span>c</span></span>
				</button>
				<button id="metricsbtn">
					<img src="res/psnr.svg" width="20">
					<span class="en">Image quality metrics (PSNR,MSE, etc)</span>
					<span class="ja">画質メトリクス (PSNR,MSE, etc)</span>
					<span class="flat keys"><span>m</span></span>
				</button>
				<button id="tonecurvebtn">
					<img src="res/tonecurve.svg" width="20">
					<span class="en">Tone Curve Estimation</span>
					<span class="ja">トーンカーブ推定</span>
					<span class="flat keys"><span>t</span></span>
				</button>
				<button id="diffbtn">
					<img src="res/diff.svg" width="20">
					<span class="en">Image diff</span>
					<span class="ja">画像のdiff</span>
					<span class="flat keys"><span>d</span></span>
				</button>
			</div>
		</div>
	</div>
	<div id="histogram" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/histogram.svg" width="20">
					<span class="en">Histogram</span>
					<span class="ja">ヒストグラム</span>
				</h3>
				<div id="histogramType" class="mode-sw">
					<button class="current">1. RGB</button>
					<button>2. <span class="en">Luminance</span><span class="ja">輝度</span></button>
				</div>
			</div>
			<table id="histoTable">
				<tr></tr>
				<tr></tr>
			</table>
		</div>
	</div>
	<div id="waveform" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/waveform.svg" width="20">
					<span class="en">Waveform</span>
					<span class="ja">波形</span>
				</h3>
				<div id="waveformType" class="mode-sw">
					<button class="current">1. RGB</button>
					<button>2. <span class="en">Luminance</span><span class="ja">輝度</span></button>
				</div>
			</div>
			<table id="waveTable">
				<tr></tr>
				<tr></tr>
			</table>
		</div>
	</div>
	<div id="vectorscope" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/vectorscope.svg" width="20">
					<span class="en">Vectorscope</span>
					<span class="ja">ベクトルスコープ</span>
				</h3>
				<div id="vectorscopeType" class="mode-sw">
					<button class="current">1. Cb-Cr</button>
					<button>2. x-y</button>
					<button>3. G-B</button>
					<button>4. G-R</button>
					<button>5. B-R</button>
				</div>
			</div>
			<table id="vectorscopeTable">
				<tr></tr>
				<tr></tr>
			</table>
		</div>
	</div>
	<div id="colorDist" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/colordist.svg" width="20">
					<span class="en">3D Color Distribution</span>
					<span class="ja">3次元色分布</span>
				</h3>
			</div>
			<table id="colorDistTable">
				<tr></tr>
				<tr></tr>
			</table>
		</div>
	</div>
	<div id="metrics" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/psnr.svg" width="20">
					<span class="en">Image quality metrics</span>
					<span class="ja">画質メトリクス</span>
				</h3>
			</div>
			<div>
				<table id="metricsTable">
					<tr id="metricsBaseName">
						<td class="prop">
							<span class="en">Base Image</span>
							<span class="ja">基準画像</span>
						</td>
					</tr>
					<tr id="metricsTargetName">
						<td class="prop">
							<span class="en">Target Image</span>
							<span class="ja">対象画像</span>
						</td>
					</tr>
					<tr id="psnrValue" class="num">
						<td class="prop">
							<span class="en">PSNR (*)</span>
							<span class="ja">PSNR (※)</span>
						</td>
					</tr>
					<tr id="rmseValue" class="num">
						<td class="prop">
							<span class="en">RMSE (*)</span>
							<span class="ja">RMSE (※)</span>
						</td>
					</tr>
					<tr id="mseValue" class="num">
						<td class="prop">
							<span class="en">MSE (*)</span>
							<span class="ja">MSE (※)</span>
						</td>
					</tr>
					<tr id="nccValue" class="num">
						<td class="prop">
							<span class="en">NCC (*)</span>
							<span class="ja">NCC (※)</span>
						</td>
					</tr>
					<tr id="aeValue" class="num">
						<td class="prop">
							<span class="en">Number of different pixels</span>
							<span class="ja">異なるピクセルの数</span>
						</td>
					</tr>
				</table>
				<div class="footnote">
					<span class="en">
						* PSNR = Peak signal-to-noise ratio (<strong>higher</strong> is more similar)<br>
						* RMSE = Root-mean-square error (<strong>lower</strong> is more similar)<br>
						* MSE = Mean squared error (<strong>lower</strong> is more similar)<br>
						* NCC = Normalized cross-correlation (<strong>higher</strong> is more similar)
					</span>
					<span class="ja">
						※PSNR (Peak signal-to-noise ratio) = ピーク信号対雑音比 (<strong>大きい</strong>方が似ている)<br>
						※RMSE (Root-mean-square error) = 平均二乗誤差の平方根 (<strong>小さい</strong>方が似ている)<br>
						※MSE (Mean squared error) = 平均二乗誤差 (<strong>小さい</strong>方が似ている)<br>
						※NCC (Normalized cross-correlation) = 正規化相互相関 (<strong>大きい</strong>方が似ている)
					</span>
				</div>
			</div>
		</div>
	</div>
	<div id="toneCurve" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/tonecurve.svg" width="20">
					<span class="en">Tone Curve Estimation</span>
					<span class="ja">トーンカーブ推定</span>
				</h3>
				<div id="toneCurveType" class="mode-sw">
					<button>1. RGB</button>
					<button class="current">2. <span class="en">Luminance</span><span class="ja">輝度</span></button>
				</div>
			</div>
			<div>
				<table id="toneCurveTable">
					<tr>
						<td class="prop">
							<span class="en">Base Image</span>
							<span class="ja">基準画像</span>
						</td>
						<td id="toneCurveBaseName" colspan="2" style="min-width: 216px"></td>
						<td class="input" rowspan="2" style="width:40px; max-width: 40px"><button class="swapbtn" style="display:inline-block; width:40px; height:40px;"><img src="res/swap.svg" width="100%"></button></td>
					</tr>
					<tr>
						<td class="prop">
							<span class="en">Target Image</span>
							<span class="ja">対象画像</span>
						</td>
						<td id="toneCurveTargetName" colspan="2"></td>
					</tr>
					<tr>
						<td id="toneCurveResult" class="fig" colspan="4"></td>
					</tr>
				</table>
				<div class="footnote">
					<span class="en">
						* The curve is the estimated tone curve calculated based on the histogram so that the cumulative frequency for each luminance of each image matches.<br>
						* The shading in the figure show the distribution of tone map between every corresponding pixels of the two images.
					</span>
					<span class="ja">
						※ 曲線は、各画像の輝度ごとの累積度数が一致するようにヒストグラムを元にして計算された推定トーンカーブです<br>
						※ 図の濃淡は、2つの画像の対応するピクセル間の輝度の対応（トーンマップ）の分布を示します
					</span>
				</div>
			</div>
		</div>
	</div>
	<div id="diff" class="dialog">
		<div>
			<div class="header">
				<h3>
					<img src="res/diff.svg" width="20">
					<span class="en">Image diff</span>
					<span class="ja">画像のdiff</span>
				</h3>
			</div>
			<div>
				<table id="diffTable">
					<tr>
						<td class="prop">
							<span class="en">Base Image</span>
							<span class="ja">基準画像</span>
						</td>
						<td id="diffBaseName" colspan="2" style="min-width: 216px"></td>
						<td class="input" rowspan="2" style="width:40px; max-width: 40px"><button class="swapbtn" style="display:inline-block; width:40px; height:40px;"><img src="res/swap.svg" width="100%"></button></td>
					</tr>
					<tr>
						<td class="prop">
							<span class="en">Target Image</span>
							<span class="ja">対象画像</span>
						</td>
						<td id="diffTargetName" colspan="2"></td>
					</tr>
					<tr class="num diffDimension">
						<td class="prop" rowspan="3">
							<span class="en">Dimension</span>
							<span class="ja">画像サイズ</span>
						</td>
						<td class="output" colspan="3">
							&nbsp;<span id="diffDimensionReport"></span>
						</td>
					</tr>
					<tr class="diffDimension">
						<td class="input" colspan="1">
							<span class="en">dimension option:</span>
							<span class="ja">画像サイズオプション:</span>
						</td>
						<td class="input" colspan="2">
							<select class="diffDimensionOption en">
								<option value="resize">resize to fit to larger one</option>
								<option value="max">no resize (compare in larger dimension)</option>
								<option value="min">no resize (compare in smaller dimension)</option>
							</select>
							<select class="diffDimensionOption ja">
								<option value="resize">大きい方に合わせてリサイズ</option>
								<option value="max">リサイズなし（大きいサイズで比較）</option>
								<option value="min">リサイズなし（小さいサイズで比較）</option>
							</select>
						</td>
					</tr>
					<tr class="diffDimension">
						<td class="input" colspan="1">
							<span class="en">resize method:</span>
							<span class="ja">リサイズ方法:</span>
						</td>
						<td class="input" colspan="2">
							<select id="diffResizeMethod">
								<option value="lanczos3">Lanczos3</option>
								<option value="lanczos2">Lanczos2</option>
								<option value="bilinear">Bilinear</option>
								<option value="nn">Nearest neighbor</option>
							</select>
						</td>
					</tr>
					<tr>
						<td class="prop" rowspan="2">
							<span class="en">Offset</span>
							<span class="ja">オフセット</span>
						</td>
						<td class="input" colspan="1">
							<span class="en">horizontal offset [px]</span>
							<span class="ja">水平オフセット [px]</span>
						</td>
						<td class="input" colspan="2" style="min-width:auto"><input id="diffOffsetX" type="number" min="-9999" max="9999" value="0"></td>
					</tr>
					<tr class="num">
						<td class="input">
							<span class="en">vertical offset [px]</span>
							<span class="ja">垂直オフセット [px]</span>
						</td>
						<td class="input" colspan="2" style="min-width:auto"><input id="diffOffsetY" type="number" min="-9999" max="9999" value="0"></td>
					</tr>
					<tr>
						<td class="prop" rowspan="3">
							<span class="en">RGBA error</span>
							<span class="ja">RGBA誤差</span>
						</td>
						<td class="output" colspan="1">
							<span class="en">detected maximum error value:</span>
							<span class="ja">検出した最大誤差:</span>
						</td>
						<td class="output" colspan="2" id="diffDetectedMaxAE"></td>
					</tr>
					<tr class="num">
						<td class="input" colspan="1">
							<span class="en">maximum error to ignore</span>
							<span class="ja">無視する誤差の大きさ</span>
							(0 - 255)
						</td>
						<td class="input" colspan="2" style="min-width:auto"><input id="diffIgnoreAE" type="number" min="0" max="255" value="0"></td>
					</tr>
					<tr class="prop">
						<td class="output" colspan="1">
							<span class="en">ignored unmatched pixels:</span>
							<span class="ja">無視した不一致ピクセル:</span>
						</td>
						<td class="output" colspan="2" id="diffIgnoreAEResult"></td>
					</tr>
					<tr>
						<td class="output" colspan="4" style="text-align:center">
							<span id="diffSummary"></span>
							<span style="float:right">
								<a id="diffSaveFigure" href="#">
									<span class="en">Save this figure</span>
									<span class="ja">この図を保存</span>
								</a>
								<a id="diffSaveFigureHelper" download="imagediff.png" href="#" style="display:none"></a>
							</span>
						</td>
					</tr>
					<tr>
						<td id="diffResult" class="fig" colspan="4"></td>
					</tr>
				</table>
				<div class="footnote">
					<span class="en">
						* Different parts of the two images are indicated in color.
					</span>
					<span class="ja">
						※ 2つの画像の異なる部分を色で示しています
					</span>
				</div>
			</div>
		</div>
	</div>
	<div id="messageBox" class="dialog">
		<div>
			<div class="header" id="messageBoxBody">
			</div>
		</div>
	</div>
</div>

</body>
</html>
